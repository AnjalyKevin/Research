import numpy as np # linear algebra
import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)
import seaborn as sns
import matplotlib.pyplot as plt
import warnings
warnings.filterwarnings("ignore")

sns.set(style="whitegrid")

df = pd.read_csv('/kddcup99_csv.csv')
df

df.columns

df.shape

df.info()

input_cols = list(df.columns)[1:-1]
target_col = 'label'
numeric_cols = df.select_dtypes(include=np.number).columns.tolist()[:-1]

from sklearn.preprocessing import MinMaxScaler
scaler = MinMaxScaler()
scaler.fit(df[numeric_cols])
df[numeric_cols] = scaler.transform(df[numeric_cols])

from sklearn.preprocessing import LabelEncoder
le = LabelEncoder()

target = df['label']
df['label'] = le.fit_transform(target)
df['protocol_type'] = le.fit_transform(df['protocol_type'])
df['service'] = le.fit_transform(df['service'])
df['flag'] = le.fit_transform(df['flag'])


plt.figure(figsize=(8, 6))
protocol_counts = df['protocol_type'].value_counts()
sns.barplot(x=protocol_counts.index, y=protocol_counts.values, palette="Blues_d")
plt.title("Distribution of Protocol Types", fontsize=16)
plt.xlabel("Protocol Type", fontsize=12)
plt.ylabel("Count", fontsize=12)
plt.xticks(rotation=45)
plt.show()


plt.figure(figsize=(15, 12))
correlation_matrix = df.corr()
sns.heatmap(correlation_matrix, cmap='coolwarm', annot=False, cbar=True)
plt.title("Correlation Heatmap of Features", fontsize=16)
plt.show()


plt.figure(figsize=(10, 8))
sns.scatterplot(data=df, x='src_bytes', y='dst_bytes', hue='label', alpha=0.5, palette="Set1")
plt.title("Source Bytes vs Destination Bytes", fontsize=16)
plt.xlabel("Source Bytes", fontsize=12)
plt.ylabel("Destination Bytes", fontsize=12)
plt.legend(loc='upper right', title="Label")
plt.show()


time_traffic = df.groupby('duration')['src_bytes'].sum().reset_index()
plt.figure(figsize=(10, 6))
plt.plot(time_traffic['duration'], time_traffic['src_bytes'], label='Src Bytes', color='blue')
plt.title("Network Traffic Over Time", fontsize=16)
plt.xlabel("Duration", fontsize=12)
plt.ylabel("Aggregated Source Bytes", fontsize=12)
plt.legend()
plt.show()



